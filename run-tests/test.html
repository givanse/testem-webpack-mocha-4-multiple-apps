<html>
  <head>
    <title>Tests Runner</title>
    <link rel="stylesheet" href="../node_modules/mocha/mocha.css">
  </head>

  <body>
    <div id="mocha"></div>
    <script src="../node_modules/mocha/mocha.js"></script>
    <script>mocha.setup("bdd")</script>

    <script src="/testem.js"></script>

    <script>
      const port = window.location.search.match(/port=(\d*)/)[1];
      if (!port) {
        throw new Error('No port found in the query string.');
      }

      const s = document.createElement("script");
      const url = `http://localhost:${port}/test-bundle.js`;
      s.setAttribute("src", url);

      s.onload = function() {
        mocha.run();
      };

      document.body.appendChild(s);
    </script>

  </body>
</html>
